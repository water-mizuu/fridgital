{
    "sourceFile": "lib/widgets/shared/miscellaneous/shrinking_navigation.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 29,
            "patches": [
                {
                    "date": 1698745464139,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1698747733766,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n     const padding = 8.0;\r\n     const indicator = (width: 16.0, height: 4.0);\r\n \r\n     var activeIndex = TabInformation.of(context).index;\r\n-    var width = MediaQuery.sizeOf(context).width - margin * 2 - padding * 2;\r\n+    var width = MediaQuery.sizeOf(context).width;\r\n     var arbitraryRetracted = iconSize + padding * 2;\r\n \r\n     return Padding(\r\n       padding: const EdgeInsets.all(margin),\r\n"
                },
                {
                    "date": 1698747870487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -216,9 +216,9 @@\n                           child: MouseRegion(\r\n                             cursor: SystemMouseCursors.click,\r\n                             child: GestureDetector(\r\n                               onTap: toggleRetracted,\r\n-                              child: const Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n+                              child: ,\r\n                             ),\r\n                           ),\r\n                         ),\r\n                       ],\r\n"
                },
                {
                    "date": 1698747906707,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n     const padding = 8.0;\r\n     const indicator = (width: 16.0, height: 4.0);\r\n \r\n     var activeIndex = TabInformation.of(context).index;\r\n-    var width = MediaQuery.sizeOf(context).width;\r\n+    var width = MediaQuery.sizeOf(context).width - margin * 2;\r\n     var arbitraryRetracted = iconSize + padding * 2;\r\n \r\n     return Padding(\r\n       padding: const EdgeInsets.all(margin),\r\n@@ -154,9 +154,9 @@\n           ),\r\n \r\n           /// Actual displayed.\r\n           AnimatedContainer(\r\n-            padding: const EdgeInsets.all(padding),\r\n+            // padding: const EdgeInsets.all(padding),\r\n             decoration: BoxDecoration(\r\n               color: FigmaColors.whiteAccent,\r\n               borderRadius: BorderRadius.circular(256.0),\r\n             ),\r\n@@ -191,9 +191,9 @@\n                               },\r\n                               child: Container(\r\n                                 height: iconSize,\r\n                                 width: iconSize,\r\n-                                color: Colors.transparent,\r\n+                                color: Colors.green,\r\n                                 key: navigationKeys[i],\r\n                                 child: Center(\r\n                                   child: Icon(\r\n                                     const [\r\n@@ -216,9 +216,14 @@\n                           child: MouseRegion(\r\n                             cursor: SystemMouseCursors.click,\r\n                             child: GestureDetector(\r\n                               onTap: toggleRetracted,\r\n-                              child: ,\r\n+                              child: Container(\r\n+                                width: iconSize,\r\n+                                height: iconSize,\r\n+                                color: Colors.green,\r\n+                                child: const Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n+                              ),\r\n                             ),\r\n                           ),\r\n                         ),\r\n                       ],\r\n"
                },
                {
                    "date": 1698747936792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -154,9 +154,9 @@\n           ),\r\n \r\n           /// Actual displayed.\r\n           AnimatedContainer(\r\n-            // padding: const EdgeInsets.all(padding),\r\n+            padding: const EdgeInsets.symmetric(vertical: padding),\r\n             decoration: BoxDecoration(\r\n               color: FigmaColors.whiteAccent,\r\n               borderRadius: BorderRadius.circular(256.0),\r\n             ),\r\n@@ -191,9 +191,9 @@\n                               },\r\n                               child: Container(\r\n                                 height: iconSize,\r\n                                 width: iconSize,\r\n-                                color: Colors.green,\r\n+                                color: Colors.trans,\r\n                                 key: navigationKeys[i],\r\n                                 child: Center(\r\n                                   child: Icon(\r\n                                     const [\r\n"
                },
                {
                    "date": 1698747967469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n           IgnorePointer(\r\n             child: Opacity(\r\n               opacity: ghostOpacity,\r\n               child: Container(\r\n-                padding: const EdgeInsets.all(padding),\r\n+                padding: const EdgeInsets.symmetric(vertical: padding),\r\n                 width: arbitraryRetracted,\r\n                 child: UnconstrainedBox(\r\n                   constrainedAxis: Axis.vertical,\r\n                   alignment: Alignment.centerRight,\r\n@@ -131,9 +131,9 @@\n           IgnorePointer(\r\n             child: Opacity(\r\n               opacity: ghostOpacity,\r\n               child: Container(\r\n-                padding: const EdgeInsets.all(padding),\r\n+                padding: const EdgeInsets.symmetric(vertical: padding),\r\n                 width: width,\r\n                 child: UnconstrainedBox(\r\n                   constrainedAxis: Axis.vertical,\r\n                   alignment: Alignment.centerRight,\r\n@@ -191,9 +191,9 @@\n                               },\r\n                               child: Container(\r\n                                 height: iconSize,\r\n                                 width: iconSize,\r\n-                                color: Colors.trans,\r\n+                                color: Colors.transparent,\r\n                                 key: navigationKeys[i],\r\n                                 child: Center(\r\n                                   child: Icon(\r\n                                     const [\r\n@@ -219,9 +219,8 @@\n                               onTap: toggleRetracted,\r\n                               child: Container(\r\n                                 width: iconSize,\r\n                                 height: iconSize,\r\n-                                color: Colors.green,\r\n                                 child: const Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n                               ),\r\n                             ),\r\n                           ),\r\n"
                },
                {
                    "date": 1698748022549,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n           IgnorePointer(\r\n             child: Opacity(\r\n               opacity: ghostOpacity,\r\n               child: Container(\r\n-                padding: const EdgeInsets.symmetric(vertical: padding),\r\n+                padding: const EdgeInsets.all(padding),\r\n                 width: arbitraryRetracted,\r\n                 child: UnconstrainedBox(\r\n                   constrainedAxis: Axis.vertical,\r\n                   alignment: Alignment.centerRight,\r\n@@ -182,46 +182,21 @@\n                     child: Row(\r\n                       mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n                       children: [\r\n                         for (int i in 4.times)\r\n-                          MouseRegion(\r\n-                            cursor: SystemMouseCursors.click,\r\n-                            child: GestureDetector(\r\n-                              onTap: () {\r\n-                                ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n-                              },\r\n-                              child: Container(\r\n-                                height: iconSize,\r\n-                                width: iconSize,\r\n-                                color: Colors.transparent,\r\n-                                key: navigationKeys[i],\r\n-                                child: Center(\r\n-                                  child: Icon(\r\n-                                    const [\r\n-                                      FigmaIconFont.book,\r\n-                                      FigmaIconFont.fridge,\r\n-                                      Icons.home_outlined,\r\n-                                      Icons.list_alt_outlined,\r\n-                                    ][i],\r\n-                                    size: iconSize,\r\n-                                    color: FigmaColors.pinkAccent,\r\n-                                  ),\r\n-                                ),\r\n-                              ),\r\n-                            ),\r\n-                          ),\r\n+                          ,\r\n                         AnimatedTransform.translate(\r\n                           duration: retractDuration,\r\n                           offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                           curve: Curves.fastOutSlowIn,\r\n                           child: MouseRegion(\r\n                             cursor: SystemMouseCursors.click,\r\n                             child: GestureDetector(\r\n                               onTap: toggleRetracted,\r\n-                              child: Container(\r\n+                              child: const SizedBox(\r\n                                 width: iconSize,\r\n                                 height: iconSize,\r\n-                                child: const Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n+                                child: Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n                               ),\r\n                             ),\r\n                           ),\r\n                         ),\r\n"
                },
                {
                    "date": 1698748186504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -182,9 +182,39 @@\n                     child: Row(\r\n                       mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n                       children: [\r\n                         for (int i in 4.times)\r\n-                          ,\r\n+                          AnimatedTransform.translate(\r\n+                            duration: retractDuration,\r\n+                            // offset: isRetracted ? -retractedOffset : Offset.zero,\r\n+                            curve: Curves.fastOutSlowIn,\r\n+                            child: MouseRegion(\r\n+                              cursor: SystemMouseCursors.click,\r\n+                              child: GestureDetector(\r\n+                                onTap: () {\r\n+                                  ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n+                                },\r\n+                                child: Container(\r\n+                                  height: iconSize,\r\n+                                  width: iconSize,\r\n+                                  color: Colors.transparent,\r\n+                                  key: navigationKeys[i],\r\n+                                  child: Center(\r\n+                                    child: Icon(\r\n+                                      const [\r\n+                                        FigmaIconFont.book,\r\n+                                        FigmaIconFont.fridge,\r\n+                                        Icons.home_outlined,\r\n+                                        Icons.list_alt_outlined,\r\n+                                      ][i],\r\n+                                      size: iconSize,\r\n+                                      color: FigmaColors.pinkAccent,\r\n+                                    ),\r\n+                                  ),\r\n+                                ),\r\n+                              ),\r\n+                            ),\r\n+                          ),\r\n                         AnimatedTransform.translate(\r\n                           duration: retractDuration,\r\n                           offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                           curve: Curves.fastOutSlowIn,\r\n"
                },
                {
                    "date": 1698748247594,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -184,9 +184,10 @@\n                       children: [\r\n                         for (int i in 4.times)\r\n                           AnimatedTransform.translate(\r\n                             duration: retractDuration,\r\n-                            // offset: isRetracted ? -retractedOffset : Offset.zero,\r\n+                            offset: Offset.zero,\r\n+                            offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                             curve: Curves.fastOutSlowIn,\r\n                             child: MouseRegion(\r\n                               cursor: SystemMouseCursors.click,\r\n                               child: GestureDetector(\r\n"
                },
                {
                    "date": 1698748521267,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -184,12 +184,12 @@\n                       children: [\r\n                         for (int i in 4.times)\r\n                           AnimatedTransform.translate(\r\n                             duration: retractDuration,\r\n-                            offset: Offset.zero,\r\n                             offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                             curve: Curves.fastOutSlowIn,\r\n-                            child: MouseRegion(\r\n+                            child: \r\n+                            MouseRegion(\r\n                               cursor: SystemMouseCursors.click,\r\n                               child: GestureDetector(\r\n                                 onTap: () {\r\n                                   ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n"
                },
                {
                    "date": 1698748551305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import \"package:fridgital/shared/constants.dart\";\r\n import \"package:fridgital/shared/extensions/times.dart\";\r\n import \"package:fridgital/widgets/inherited_widgets/tab_information.dart\";\r\n import \"package:fridgital/widgets/shared/helper/animated_transform.dart\";\r\n+import \"package:fridgital/widgets/shared/miscellaneous/clickable_widget.dart\";\r\n \r\n class ShrinkingNavigation extends StatefulWidget {\r\n   const ShrinkingNavigation({required this.latestScrollOffset, super.key});\r\n \r\n@@ -186,31 +187,27 @@\n                           AnimatedTransform.translate(\r\n                             duration: retractDuration,\r\n                             offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                             curve: Curves.fastOutSlowIn,\r\n-                            child: \r\n-                            MouseRegion(\r\n-                              cursor: SystemMouseCursors.click,\r\n-                              child: GestureDetector(\r\n-                                onTap: () {\r\n-                                  ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n-                                },\r\n-                                child: Container(\r\n-                                  height: iconSize,\r\n-                                  width: iconSize,\r\n-                                  color: Colors.transparent,\r\n-                                  key: navigationKeys[i],\r\n-                                  child: Center(\r\n-                                    child: Icon(\r\n-                                      const [\r\n-                                        FigmaIconFont.book,\r\n-                                        FigmaIconFont.fridge,\r\n-                                        Icons.home_outlined,\r\n-                                        Icons.list_alt_outlined,\r\n-                                      ][i],\r\n-                                      size: iconSize,\r\n-                                      color: FigmaColors.pinkAccent,\r\n-                                    ),\r\n+                            child: ClickableWidget(\r\n+                              onTap: () {\r\n+                                ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n+                              },\r\n+                              child: Container(\r\n+                                height: iconSize,\r\n+                                width: iconSize,\r\n+                                color: Colors.transparent,\r\n+                                key: navigationKeys[i],\r\n+                                child: Center(\r\n+                                  child: Icon(\r\n+                                    const [\r\n+                                      FigmaIconFont.book,\r\n+                                      FigmaIconFont.fridge,\r\n+                                      Icons.home_outlined,\r\n+                                      Icons.list_alt_outlined,\r\n+                                    ][i],\r\n+                                    size: iconSize,\r\n+                                    color: FigmaColors.pinkAccent,\r\n                                   ),\r\n                                 ),\r\n                               ),\r\n                             ),\r\n@@ -218,41 +215,23 @@\n                         AnimatedTransform.translate(\r\n                           duration: retractDuration,\r\n                           offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                           curve: Curves.fastOutSlowIn,\r\n-                          child: MouseRegion(\r\n-                            cursor: SystemMouseCursors.click,\r\n-                            child: GestureDetector(\r\n-                              onTap: toggleRetracted,\r\n-                              child: const SizedBox(\r\n-                                width: iconSize,\r\n-                                height: iconSize,\r\n-                                child: Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n-                              ),\r\n+                          child: ClickableWidget(\r\n+                            onTap: toggleRetracted,\r\n+                            child: const SizedBox(\r\n+                              width: iconSize,\r\n+                              height: iconSize,\r\n+                              child: Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n                             ),\r\n                           ),\r\n                         ),\r\n                       ],\r\n                     ),\r\n                   ),\r\n                 ),\r\n                 if (!isRetracted && hasComputedOffsets)\r\n-                  AnimatedTransform.translate(\r\n-                    offset: navigationOffsets[activeIndex],\r\n-                    duration: retractDuration,\r\n-                    curve: Curves.fastOutSlowIn,\r\n-                    child: Opacity(\r\n-                      opacity: isRetracted ? 0.0 : 1.0,\r\n-                      child: Container(\r\n-                        width: indicator.width,\r\n-                        height: indicator.height,\r\n-                        decoration: BoxDecoration(\r\n-                          color: FigmaColors.pinkAccent,\r\n-                          borderRadius: BorderRadius.circular(256.0),\r\n-                        ),\r\n-                      ),\r\n-                    ),\r\n-                  ),\r\n+                  IgnorePointer(child: ),\r\n               ],\r\n             ),\r\n           ),\r\n         ],\r\n"
                },
                {
                    "date": 1698748657424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,9 +117,8 @@\n                     width: width,\r\n                     child: Row(\r\n                       mainAxisAlignment: MainAxisAlignment.spaceBetween,\r\n                       children: [\r\n-                        for (void _ in 4.times) const SizedBox(height: iconSize, width: iconSize),\r\n                         Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent, key: retractedKey),\r\n                       ],\r\n                     ),\r\n                   ),\r\n@@ -229,9 +228,26 @@\n                     ),\r\n                   ),\r\n                 ),\r\n                 if (!isRetracted && hasComputedOffsets)\r\n-                  IgnorePointer(child: ),\r\n+                  IgnorePointer(\r\n+                    child: AnimatedTransform.translate(\r\n+                      offset: navigationOffsets[activeIndex],\r\n+                      duration: retractDuration,\r\n+                      curve: Curves.fastOutSlowIn,\r\n+                      child: Opacity(\r\n+                        opacity: isRetracted ? 0.0 : 1.0,\r\n+                        child: Container(\r\n+                          width: indicator.width,\r\n+                          height: indicator.height,\r\n+                          decoration: BoxDecoration(\r\n+                            color: FigmaColors.pinkAccent,\r\n+                            borderRadius: BorderRadius.circular(256.0),\r\n+                          ),\r\n+                        ),\r\n+                      ),\r\n+                    ),\r\n+                  ),\r\n               ],\r\n             ),\r\n           ),\r\n         ],\r\n"
                },
                {
                    "date": 1698755210496,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,8 +36,9 @@\n   void updateOffsets() {\r\n     if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n       for (var (i, key) in navigationKeys.indexed) {\r\n         if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n+          \r\n           navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n               Offset(0.0, box.size.height * 1.0625) +\r\n               Offset(box.size.width / 2, 0.0) +\r\n               const Offset(-8.0, 0.0);\r\n@@ -117,8 +118,9 @@\n                     width: width,\r\n                     child: Row(\r\n                       mainAxisAlignment: MainAxisAlignment.spaceBetween,\r\n                       children: [\r\n+                        for (void _ in 4.times) const SizedBox(height: iconSize, width: iconSize),\r\n                         Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent, key: retractedKey),\r\n                       ],\r\n                     ),\r\n                   ),\r\n"
                },
                {
                    "date": 1698755250425,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,13 +36,14 @@\n   void updateOffsets() {\r\n     if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n       for (var (i, key) in navigationKeys.indexed) {\r\n         if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n-          \r\n-          navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n-              Offset(0.0, box.size.height * 1.0625) +\r\n-              Offset(box.size.width / 2, 0.0) +\r\n-              const Offset(-8.0, 0.0);\r\n+          if (box.hasSize) {\r\n+            navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n+                Offset(0.0, bbox.size.height * 1.0625) +\r\n+                Offset(box.size.width / 2, 0.0) +\r\n+                const Offset(-8.0, 0.0);\r\n+          }\r\n         }\r\n       }\r\n \r\n       /// Compute the difference.\r\n"
                },
                {
                    "date": 1698755369563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,19 +36,17 @@\n   void updateOffsets() {\r\n     if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n       for (var (i, key) in navigationKeys.indexed) {\r\n         if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n-          if (box.hasSize) {\r\n-            navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n-                Offset(0.0, bbox.size.height * 1.0625) +\r\n-                Offset(box.size.width / 2, 0.0) +\r\n-                const Offset(-8.0, 0.0);\r\n-          }\r\n+          navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n+              Offset(0.0, box.hasSize ? box.size.height * 1.0625 : 0.0) +\r\n+              Offset(box.hasSize ? box.size.width / 2 : 0.0, 0.0) +\r\n+              const Offset(-8.0, 0.0);\r\n         }\r\n       }\r\n \r\n       /// Compute the difference.\r\n-      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox) {\r\n+      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox ) {\r\n         if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox) {\r\n           retractedOffset = expandedBox.localToGlobal(Offset.zero) - retractedBox.localToGlobal(Offset.zero);\r\n         }\r\n       }\r\n"
                },
                {
                    "date": 1698767213487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,8 +34,9 @@\n   }\r\n \r\n   void updateOffsets() {\r\n     if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n+      \r\n       for (var (i, key) in navigationKeys.indexed) {\r\n         if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n           navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n               Offset(0.0, box.hasSize ? box.size.height * 1.0625 : 0.0) +\r\n@@ -44,10 +45,10 @@\n         }\r\n       }\r\n \r\n       /// Compute the difference.\r\n-      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox ) {\r\n-        if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox) {\r\n+      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox when retractedBox.hasSize) {\r\n+        if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox when expandedBox.hasSize) {\r\n           retractedOffset = expandedBox.localToGlobal(Offset.zero) - retractedBox.localToGlobal(Offset.zero);\r\n         }\r\n       }\r\n \r\n"
                },
                {
                    "date": 1698767262493,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,12 +33,12 @@\n     setState(() => isRetracted = !isRetracted);\r\n   }\r\n \r\n   void updateOffsets() {\r\n-    if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n-      \r\n+    if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox when parentBox.hasSize) {\r\n+      print(parentBox.localToGlobal(Offset.zero));\r\n       for (var (i, key) in navigationKeys.indexed) {\r\n-        if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n+        if (key.currentContext?.findRenderObject() case RenderBox box when box.hasSize) {\r\n           navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n               Offset(0.0, box.hasSize ? box.size.height * 1.0625 : 0.0) +\r\n               Offset(box.hasSize ? box.size.width / 2 : 0.0, 0.0) +\r\n               const Offset(-8.0, 0.0);\r\n@@ -55,8 +55,9 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n+\r\n   @override\r\n   void initState() {\r\n     super.initState();\r\n \r\n"
                },
                {
                    "date": 1698767484926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,13 +55,20 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n+  @override\r\n+  void didChangeDependencies() {\r\n+    super.didChangeDependencies();\r\n \r\n+    print(\"CHanged\");\r\n+  }\r\n+\r\n   @override\r\n   void initState() {\r\n     super.initState();\r\n \r\n+\r\n     widget.latestScrollOffset.addListener(updateRetracted);\r\n     WidgetsBinding.instance.addPostFrameCallback((_) {\r\n       updateOffsets();\r\n     });\r\n"
                },
                {
                    "date": 1698767515502,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n import \"package:flutter/material.dart\";\r\n import \"package:fridgital/icons/figma_icon_font.dart\";\r\n import \"package:fridgital/shared/constants.dart\";\r\n import \"package:fridgital/shared/extensions/times.dart\";\r\n+import \"package:fridgital/widgets/inherited_widgets/route_state.dart\";\r\n import \"package:fridgital/widgets/inherited_widgets/tab_information.dart\";\r\n import \"package:fridgital/widgets/shared/helper/animated_transform.dart\";\r\n import \"package:fridgital/widgets/shared/miscellaneous/clickable_widget.dart\";\r\n \r\n@@ -66,9 +67,12 @@\n   @override\r\n   void initState() {\r\n     super.initState();\r\n \r\n+    var routeState = RouteState.of(context);\r\n \r\n+    routeState.popStream.((_) {});\r\n+\r\n     widget.latestScrollOffset.addListener(updateRetracted);\r\n     WidgetsBinding.instance.addPostFrameCallback((_) {\r\n       updateOffsets();\r\n     });\r\n"
                },
                {
                    "date": 1698767545647,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -67,12 +67,8 @@\n   @override\r\n   void initState() {\r\n     super.initState();\r\n \r\n-    var routeState = RouteState.of(context);\r\n-\r\n-    routeState.popStream.((_) {});\r\n-\r\n     widget.latestScrollOffset.addListener(updateRetracted);\r\n     WidgetsBinding.instance.addPostFrameCallback((_) {\r\n       updateOffsets();\r\n     });\r\n"
                },
                {
                    "date": 1698767576545,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,287 @@\n+import \"package:flutter/material.dart\";\r\n+import \"package:fridgital/icons/figma_icon_font.dart\";\r\n+import \"package:fridgital/shared/constants.dart\";\r\n+import \"package:fridgital/shared/extensions/times.dart\";\r\n+import \"package:fridgital/widgets/inherited_widgets/route_state.dart\";\r\n+import \"package:fridgital/widgets/inherited_widgets/tab_information.dart\";\r\n+import \"package:fridgital/widgets/shared/helper/animated_transform.dart\";\r\n+import \"package:fridgital/widgets/shared/miscellaneous/clickable_widget.dart\";\r\n+\r\n+class ShrinkingNavigation extends StatefulWidget {\r\n+  const ShrinkingNavigation({required this.latestScrollOffset, super.key});\r\n+\r\n+  final ValueNotifier<double> latestScrollOffset;\r\n+\r\n+  @override\r\n+  State<ShrinkingNavigation> createState() => _ShrinkingNavigationState();\r\n+}\r\n+\r\n+/// I need help. I do not know of a better way to do this.\r\n+/// It works, but I have to render three layers of the same widget\r\n+/// to compute their offsets and then animate them.\r\n+///\r\n+/// I need tips.\r\n+class _ShrinkingNavigationState extends State<ShrinkingNavigation> with TickerProviderStateMixin {\r\n+  bool isRetracted = false;\r\n+\r\n+  void updateRetracted() {\r\n+    setState(() {\r\n+      isRetracted = widget.latestScrollOffset.value > 0.0;\r\n+    });\r\n+  }\r\n+\r\n+  void toggleRetracted() {\r\n+    setState(() => isRetracted = !isRetracted);\r\n+  }\r\n+\r\n+  void updateOffsets() {\r\n+    if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox when parentBox.hasSize) {\r\n+      print(parentBox.localToGlobal(Offset.zero));\r\n+      for (var (i, key) in navigationKeys.indexed) {\r\n+        if (key.currentContext?.findRenderObject() case RenderBox box when box.hasSize) {\r\n+          navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n+              Offset(0.0, box.hasSize ? box.size.height * 1.0625 : 0.0) +\r\n+              Offset(box.hasSize ? box.size.width / 2 : 0.0, 0.0) +\r\n+              const Offset(-8.0, 0.0);\r\n+        }\r\n+      }\r\n+\r\n+      /// Compute the difference.\r\n+      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox when retractedBox.hasSize) {\r\n+        if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox when expandedBox.hasSize) {\r\n+          retractedOffset = expandedBox.localToGlobal(Offset.zero) - retractedBox.localToGlobal(Offset.zero);\r\n+        }\r\n+      }\r\n+\r\n+      setState(() => hasComputedOffsets = true);\r\n+    }\r\n+  }\r\n+\r\n+  @override\r\n+  void didChangeDependencies() {\r\n+    super.didChangeDependencies();\r\n+\r\n+    print(\"CHanged\");\r\n+  }\r\n+\r\n+  @override\r\n+  void initState() {\r\n+    super.initState();\r\n+\r\n+    var routeState = RouteState.of(context);\r\n+\r\n+    routeState.popStream.listen((_) {\r\n+      if (mounted) {\r\n+        updateOffsets();\r\n+      }\r\n+    });\r\n+\r\n+    widget.latestScrollOffset.addListener(updateRetracted);\r\n+    WidgetsBinding.instance.addPostFrameCallback((_) {\r\n+      updateOffsets();\r\n+    });\r\n+  }\r\n+\r\n+  @override\r\n+  void dispose() {\r\n+    widget.latestScrollOffset.removeListener(updateRetracted);\r\n+\r\n+    super.dispose();\r\n+  }\r\n+\r\n+  bool hasComputedOffsets = false;\r\n+  GlobalKey parentKey = GlobalKey();\r\n+\r\n+  GlobalKey retractedKey = GlobalKey();\r\n+  GlobalKey expandedKey = GlobalKey();\r\n+\r\n+  Offset retractedOffset = Offset.zero;\r\n+\r\n+  List<Offset> navigationOffsets = List.generate(4, (_) => Offset.zero);\r\n+  List<GlobalKey> navigationKeys = List.generate(4, (_) => GlobalKey());\r\n+\r\n+  @override\r\n+  Widget build(BuildContext context) {\r\n+    const ghostOpacity = 0.00;\r\n+    const retractDuration = Duration(milliseconds: 125);\r\n+\r\n+    const iconSize = 32.0;\r\n+    const margin = 20.0;\r\n+    const padding = 8.0;\r\n+    const indicator = (width: 16.0, height: 4.0);\r\n+\r\n+    var activeIndex = TabInformation.of(context).index;\r\n+    var width = MediaQuery.sizeOf(context).width - margin * 2;\r\n+    var arbitraryRetracted = iconSize + padding * 2;\r\n+\r\n+    return S(\r\n+      builder: (context) {\r\n+        return Padding(\r\n+          padding: const EdgeInsets.all(margin),\r\n+          child: Stack(\r\n+            alignment: Alignment.centerRight,\r\n+            children: [\r\n+              /// Evaluated if the navigation is retracted\r\n+              IgnorePointer(\r\n+                child: Opacity(\r\n+                  opacity: ghostOpacity,\r\n+                  child: Container(\r\n+                    padding: const EdgeInsets.all(padding),\r\n+                    width: arbitraryRetracted,\r\n+                    child: UnconstrainedBox(\r\n+                      constrainedAxis: Axis.vertical,\r\n+                      alignment: Alignment.centerRight,\r\n+                      clipBehavior: Clip.hardEdge,\r\n+                      child: SizedBox(\r\n+                        width: width,\r\n+                        child: Row(\r\n+                          mainAxisAlignment: MainAxisAlignment.spaceBetween,\r\n+                          children: [\r\n+                            for (void _ in 4.times) const SizedBox(height: iconSize, width: iconSize),\r\n+                            Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent, key: retractedKey),\r\n+                          ],\r\n+                        ),\r\n+                      ),\r\n+                    ),\r\n+                  ),\r\n+                ),\r\n+              ),\r\n+        \r\n+              /// Evaluated if the navigation is not retracted\r\n+              IgnorePointer(\r\n+                child: Opacity(\r\n+                  opacity: ghostOpacity,\r\n+                  child: Container(\r\n+                    padding: const EdgeInsets.symmetric(vertical: padding),\r\n+                    width: width,\r\n+                    child: UnconstrainedBox(\r\n+                      constrainedAxis: Axis.vertical,\r\n+                      alignment: Alignment.centerRight,\r\n+                      clipBehavior: Clip.hardEdge,\r\n+                      child: SizedBox(\r\n+                        width: width,\r\n+                        child: Row(\r\n+                          mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n+                          children: [\r\n+                            for (var i = 0; i < 4; ++i) const SizedBox(height: iconSize, width: iconSize),\r\n+                            Icon(null, size: iconSize, key: expandedKey),\r\n+                          ],\r\n+                        ),\r\n+                      ),\r\n+                    ),\r\n+                  ),\r\n+                ),\r\n+              ),\r\n+        \r\n+              /// Actual displayed.\r\n+              AnimatedContainer(\r\n+                padding: const EdgeInsets.symmetric(vertical: padding),\r\n+                decoration: BoxDecoration(\r\n+                  color: FigmaColors.whiteAccent,\r\n+                  borderRadius: BorderRadius.circular(256.0),\r\n+                ),\r\n+                onEnd: () {\r\n+                  WidgetsBinding.instance.addPostFrameCallback((_) {\r\n+                    if (!isRetracted) {\r\n+                      updateOffsets();\r\n+                    }\r\n+                  });\r\n+                },\r\n+                duration: retractDuration,\r\n+                width: isRetracted ? arbitraryRetracted : width,\r\n+                curve: Curves.fastOutSlowIn,\r\n+                child: Stack(\r\n+                  children: [\r\n+                    UnconstrainedBox(\r\n+                      key: parentKey,\r\n+                      constrainedAxis: Axis.vertical,\r\n+                      alignment: Alignment.centerRight,\r\n+                      clipBehavior: Clip.hardEdge,\r\n+                      child: SizedBox(\r\n+                        width: width,\r\n+                        child: Row(\r\n+                          mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n+                          children: [\r\n+                            for (int i in 4.times)\r\n+                              AnimatedTransform.translate(\r\n+                                duration: retractDuration,\r\n+                                offset: isRetracted ? -retractedOffset : Offset.zero,\r\n+                                curve: Curves.fastOutSlowIn,\r\n+                                child: ClickableWidget(\r\n+                                  onTap: () {\r\n+                                    ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n+                                  },\r\n+                                  child: Container(\r\n+                                    height: iconSize,\r\n+                                    width: iconSize,\r\n+                                    color: Colors.transparent,\r\n+                                    key: navigationKeys[i],\r\n+                                    child: Center(\r\n+                                      child: Icon(\r\n+                                        const [\r\n+                                          FigmaIconFont.book,\r\n+                                          FigmaIconFont.fridge,\r\n+                                          Icons.home_outlined,\r\n+                                          Icons.list_alt_outlined,\r\n+                                        ][i],\r\n+                                        size: iconSize,\r\n+                                        color: FigmaColors.pinkAccent,\r\n+                                      ),\r\n+                                    ),\r\n+                                  ),\r\n+                                ),\r\n+                              ),\r\n+                            AnimatedTransform.translate(\r\n+                              duration: retractDuration,\r\n+                              offset: isRetracted ? -retractedOffset : Offset.zero,\r\n+                              curve: Curves.fastOutSlowIn,\r\n+                              child: ClickableWidget(\r\n+                                onTap: toggleRetracted,\r\n+                                child: const SizedBox(\r\n+                                  width: iconSize,\r\n+                                  height: iconSize,\r\n+                                  child: Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n+                                ),\r\n+                              ),\r\n+                            ),\r\n+                          ],\r\n+                        ),\r\n+                      ),\r\n+                    ),\r\n+                    if (!isRetracted && hasComputedOffsets)\r\n+                      IgnorePointer(\r\n+                        child: AnimatedTransform.translate(\r\n+                          offset: navigationOffsets[activeIndex],\r\n+                          duration: retractDuration,\r\n+                          curve: Curves.fastOutSlowIn,\r\n+                          child: Opacity(\r\n+                            opacity: isRetracted ? 0.0 : 1.0,\r\n+                            child: Container(\r\n+                              width: indicator.width,\r\n+                              height: indicator.height,\r\n+                              decoration: BoxDecoration(\r\n+                                color: FigmaColors.pinkAccent,\r\n+                                borderRadius: BorderRadius.circular(256.0),\r\n+                              ),\r\n+                            ),\r\n+                          ),\r\n+                        ),\r\n+                      ),\r\n+                  ],\r\n+                ),\r\n+              ),\r\n+            ],\r\n+          ),\r\n+        );\r\n+      },\r\n+    );\r\n+  }\r\n+}\r\n+\r\n+sealed class ShrinkingNavigationNotification extends Notification {}\r\n+\r\n+class ShrinkingNavigationUpdateNotification extends ShrinkingNavigationNotification {\r\n+  ShrinkingNavigationUpdateNotification(this.index);\r\n+\r\n+  final int index;\r\n+}\r\n"
                },
                {
                    "date": 1698767641774,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -113,9 +113,11 @@\n     var activeIndex = TabInformation.of(context).index;\r\n     var width = MediaQuery.sizeOf(context).width - margin * 2;\r\n     var arbitraryRetracted = iconSize + padding * 2;\r\n \r\n-    return S(\r\n+    return StreamBuilder(\r\n+      stream: RouteState.of(context).popStream,\r\n+\r\n       builder: (context) {\r\n         return Padding(\r\n           padding: const EdgeInsets.all(margin),\r\n           child: Stack(\r\n@@ -284,279 +286,4 @@\n   ShrinkingNavigationUpdateNotification(this.index);\r\n \r\n   final int index;\r\n }\r\n-import \"package:flutter/material.dart\";\r\n-import \"package:fridgital/icons/figma_icon_font.dart\";\r\n-import \"package:fridgital/shared/constants.dart\";\r\n-import \"package:fridgital/shared/extensions/times.dart\";\r\n-import \"package:fridgital/widgets/inherited_widgets/route_state.dart\";\r\n-import \"package:fridgital/widgets/inherited_widgets/tab_information.dart\";\r\n-import \"package:fridgital/widgets/shared/helper/animated_transform.dart\";\r\n-import \"package:fridgital/widgets/shared/miscellaneous/clickable_widget.dart\";\r\n-\r\n-class ShrinkingNavigation extends StatefulWidget {\r\n-  const ShrinkingNavigation({required this.latestScrollOffset, super.key});\r\n-\r\n-  final ValueNotifier<double> latestScrollOffset;\r\n-\r\n-  @override\r\n-  State<ShrinkingNavigation> createState() => _ShrinkingNavigationState();\r\n-}\r\n-\r\n-/// I need help. I do not know of a better way to do this.\r\n-/// It works, but I have to render three layers of the same widget\r\n-/// to compute their offsets and then animate them.\r\n-///\r\n-/// I need tips.\r\n-class _ShrinkingNavigationState extends State<ShrinkingNavigation> with TickerProviderStateMixin {\r\n-  bool isRetracted = false;\r\n-\r\n-  void updateRetracted() {\r\n-    setState(() {\r\n-      isRetracted = widget.latestScrollOffset.value > 0.0;\r\n-    });\r\n-  }\r\n-\r\n-  void toggleRetracted() {\r\n-    setState(() => isRetracted = !isRetracted);\r\n-  }\r\n-\r\n-  void updateOffsets() {\r\n-    if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox when parentBox.hasSize) {\r\n-      print(parentBox.localToGlobal(Offset.zero));\r\n-      for (var (i, key) in navigationKeys.indexed) {\r\n-        if (key.currentContext?.findRenderObject() case RenderBox box when box.hasSize) {\r\n-          navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n-              Offset(0.0, box.hasSize ? box.size.height * 1.0625 : 0.0) +\r\n-              Offset(box.hasSize ? box.size.width / 2 : 0.0, 0.0) +\r\n-              const Offset(-8.0, 0.0);\r\n-        }\r\n-      }\r\n-\r\n-      /// Compute the difference.\r\n-      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox when retractedBox.hasSize) {\r\n-        if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox when expandedBox.hasSize) {\r\n-          retractedOffset = expandedBox.localToGlobal(Offset.zero) - retractedBox.localToGlobal(Offset.zero);\r\n-        }\r\n-      }\r\n-\r\n-      setState(() => hasComputedOffsets = true);\r\n-    }\r\n-  }\r\n-\r\n-  @override\r\n-  void didChangeDependencies() {\r\n-    super.didChangeDependencies();\r\n-\r\n-    print(\"CHanged\");\r\n-  }\r\n-\r\n-  @override\r\n-  void initState() {\r\n-    super.initState();\r\n-\r\n-    widget.latestScrollOffset.addListener(updateRetracted);\r\n-    WidgetsBinding.instance.addPostFrameCallback((_) {\r\n-      updateOffsets();\r\n-    });\r\n-  }\r\n-\r\n-  @override\r\n-  void dispose() {\r\n-    widget.latestScrollOffset.removeListener(updateRetracted);\r\n-\r\n-    super.dispose();\r\n-  }\r\n-\r\n-  bool hasComputedOffsets = false;\r\n-  GlobalKey parentKey = GlobalKey();\r\n-\r\n-  GlobalKey retractedKey = GlobalKey();\r\n-  GlobalKey expandedKey = GlobalKey();\r\n-\r\n-  Offset retractedOffset = Offset.zero;\r\n-\r\n-  List<Offset> navigationOffsets = List.generate(4, (_) => Offset.zero);\r\n-  List<GlobalKey> navigationKeys = List.generate(4, (_) => GlobalKey());\r\n-\r\n-  @override\r\n-  Widget build(BuildContext context) {\r\n-    const ghostOpacity = 0.00;\r\n-    const retractDuration = Duration(milliseconds: 125);\r\n-\r\n-    const iconSize = 32.0;\r\n-    const margin = 20.0;\r\n-    const padding = 8.0;\r\n-    const indicator = (width: 16.0, height: 4.0);\r\n-\r\n-    var activeIndex = TabInformation.of(context).index;\r\n-    var width = MediaQuery.sizeOf(context).width - margin * 2;\r\n-    var arbitraryRetracted = iconSize + padding * 2;\r\n-\r\n-    return Padding(\r\n-      padding: const EdgeInsets.all(margin),\r\n-      child: Stack(\r\n-        alignment: Alignment.centerRight,\r\n-        children: [\r\n-          /// Evaluated if the navigation is retracted\r\n-          IgnorePointer(\r\n-            child: Opacity(\r\n-              opacity: ghostOpacity,\r\n-              child: Container(\r\n-                padding: const EdgeInsets.all(padding),\r\n-                width: arbitraryRetracted,\r\n-                child: UnconstrainedBox(\r\n-                  constrainedAxis: Axis.vertical,\r\n-                  alignment: Alignment.centerRight,\r\n-                  clipBehavior: Clip.hardEdge,\r\n-                  child: SizedBox(\r\n-                    width: width,\r\n-                    child: Row(\r\n-                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\r\n-                      children: [\r\n-                        for (void _ in 4.times) const SizedBox(height: iconSize, width: iconSize),\r\n-                        Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent, key: retractedKey),\r\n-                      ],\r\n-                    ),\r\n-                  ),\r\n-                ),\r\n-              ),\r\n-            ),\r\n-          ),\r\n-\r\n-          /// Evaluated if the navigation is not retracted\r\n-          IgnorePointer(\r\n-            child: Opacity(\r\n-              opacity: ghostOpacity,\r\n-              child: Container(\r\n-                padding: const EdgeInsets.symmetric(vertical: padding),\r\n-                width: width,\r\n-                child: UnconstrainedBox(\r\n-                  constrainedAxis: Axis.vertical,\r\n-                  alignment: Alignment.centerRight,\r\n-                  clipBehavior: Clip.hardEdge,\r\n-                  child: SizedBox(\r\n-                    width: width,\r\n-                    child: Row(\r\n-                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n-                      children: [\r\n-                        for (var i = 0; i < 4; ++i) const SizedBox(height: iconSize, width: iconSize),\r\n-                        Icon(null, size: iconSize, key: expandedKey),\r\n-                      ],\r\n-                    ),\r\n-                  ),\r\n-                ),\r\n-              ),\r\n-            ),\r\n-          ),\r\n-\r\n-          /// Actual displayed.\r\n-          AnimatedContainer(\r\n-            padding: const EdgeInsets.symmetric(vertical: padding),\r\n-            decoration: BoxDecoration(\r\n-              color: FigmaColors.whiteAccent,\r\n-              borderRadius: BorderRadius.circular(256.0),\r\n-            ),\r\n-            onEnd: () {\r\n-              WidgetsBinding.instance.addPostFrameCallback((_) {\r\n-                if (!isRetracted) {\r\n-                  updateOffsets();\r\n-                }\r\n-              });\r\n-            },\r\n-            duration: retractDuration,\r\n-            width: isRetracted ? arbitraryRetracted : width,\r\n-            curve: Curves.fastOutSlowIn,\r\n-            child: Stack(\r\n-              children: [\r\n-                UnconstrainedBox(\r\n-                  key: parentKey,\r\n-                  constrainedAxis: Axis.vertical,\r\n-                  alignment: Alignment.centerRight,\r\n-                  clipBehavior: Clip.hardEdge,\r\n-                  child: SizedBox(\r\n-                    width: width,\r\n-                    child: Row(\r\n-                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n-                      children: [\r\n-                        for (int i in 4.times)\r\n-                          AnimatedTransform.translate(\r\n-                            duration: retractDuration,\r\n-                            offset: isRetracted ? -retractedOffset : Offset.zero,\r\n-                            curve: Curves.fastOutSlowIn,\r\n-                            child: ClickableWidget(\r\n-                              onTap: () {\r\n-                                ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n-                              },\r\n-                              child: Container(\r\n-                                height: iconSize,\r\n-                                width: iconSize,\r\n-                                color: Colors.transparent,\r\n-                                key: navigationKeys[i],\r\n-                                child: Center(\r\n-                                  child: Icon(\r\n-                                    const [\r\n-                                      FigmaIconFont.book,\r\n-                                      FigmaIconFont.fridge,\r\n-                                      Icons.home_outlined,\r\n-                                      Icons.list_alt_outlined,\r\n-                                    ][i],\r\n-                                    size: iconSize,\r\n-                                    color: FigmaColors.pinkAccent,\r\n-                                  ),\r\n-                                ),\r\n-                              ),\r\n-                            ),\r\n-                          ),\r\n-                        AnimatedTransform.translate(\r\n-                          duration: retractDuration,\r\n-                          offset: isRetracted ? -retractedOffset : Offset.zero,\r\n-                          curve: Curves.fastOutSlowIn,\r\n-                          child: ClickableWidget(\r\n-                            onTap: toggleRetracted,\r\n-                            child: const SizedBox(\r\n-                              width: iconSize,\r\n-                              height: iconSize,\r\n-                              child: Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n-                            ),\r\n-                          ),\r\n-                        ),\r\n-                      ],\r\n-                    ),\r\n-                  ),\r\n-                ),\r\n-                if (!isRetracted && hasComputedOffsets)\r\n-                  IgnorePointer(\r\n-                    child: AnimatedTransform.translate(\r\n-                      offset: navigationOffsets[activeIndex],\r\n-                      duration: retractDuration,\r\n-                      curve: Curves.fastOutSlowIn,\r\n-                      child: Opacity(\r\n-                        opacity: isRetracted ? 0.0 : 1.0,\r\n-                        child: Container(\r\n-                          width: indicator.width,\r\n-                          height: indicator.height,\r\n-                          decoration: BoxDecoration(\r\n-                            color: FigmaColors.pinkAccent,\r\n-                            borderRadius: BorderRadius.circular(256.0),\r\n-                          ),\r\n-                        ),\r\n-                      ),\r\n-                    ),\r\n-                  ),\r\n-              ],\r\n-            ),\r\n-          ),\r\n-        ],\r\n-      ),\r\n-    );\r\n-  }\r\n-}\r\n-\r\n-sealed class ShrinkingNavigationNotification extends Notification {}\r\n-\r\n-class ShrinkingNavigationUpdateNotification extends ShrinkingNavigationNotification {\r\n-  ShrinkingNavigationUpdateNotification(this.index);\r\n-\r\n-  final int index;\r\n-}\r\n"
                },
                {
                    "date": 1698767672535,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,8 +56,10 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n+  void s\r\n+\r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n@@ -67,16 +69,8 @@\n   @override\r\n   void initState() {\r\n     super.initState();\r\n \r\n-    var routeState = RouteState.of(context);\r\n-\r\n-    routeState.popStream.listen((_) {\r\n-      if (mounted) {\r\n-        updateOffsets();\r\n-      }\r\n-    });\r\n-\r\n     widget.latestScrollOffset.addListener(updateRetracted);\r\n     WidgetsBinding.instance.addPostFrameCallback((_) {\r\n       updateOffsets();\r\n     });\r\n@@ -115,10 +109,9 @@\n     var arbitraryRetracted = iconSize + padding * 2;\r\n \r\n     return StreamBuilder(\r\n       stream: RouteState.of(context).popStream,\r\n-\r\n-      builder: (context) {\r\n+      builder: (context, snapshot) {\r\n         return Padding(\r\n           padding: const EdgeInsets.all(margin),\r\n           child: Stack(\r\n             alignment: Alignment.centerRight,\r\n@@ -147,9 +140,9 @@\n                     ),\r\n                   ),\r\n                 ),\r\n               ),\r\n-        \r\n+\r\n               /// Evaluated if the navigation is not retracted\r\n               IgnorePointer(\r\n                 child: Opacity(\r\n                   opacity: ghostOpacity,\r\n@@ -173,9 +166,9 @@\n                     ),\r\n                   ),\r\n                 ),\r\n               ),\r\n-        \r\n+\r\n               /// Actual displayed.\r\n               AnimatedContainer(\r\n                 padding: const EdgeInsets.symmetric(vertical: padding),\r\n                 decoration: BoxDecoration(\r\n"
                },
                {
                    "date": 1698767704699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,15 +56,15 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n-  void s\r\n+  void popStreamListener() {}\r\n \r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n-    print(\"CHanged\");\r\n+\r\n   }\r\n \r\n   @override\r\n   void initState() {\r\n"
                },
                {
                    "date": 1698767916318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,15 +56,17 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n-  void popStreamListener() {}\r\n+  void popStreamListener(void _) {}\r\n \r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n-\r\n+    var stream  RouteState.of(context).popStream;\r\n+    \r\n+    stream.listen(popStreamListener);\r\n   }\r\n \r\n   @override\r\n   void initState() {\r\n"
                },
                {
                    "date": 1698767952424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,9 @@\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n-    var stream  RouteState.of(context).popStream;\r\n+     RouteState.of(context).registerAsListener(popStreamListener);\r\n     \r\n     stream.listen(popStreamListener);\r\n   }\r\n \r\n"
                },
                {
                    "date": 1698767985466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,17 +56,15 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n-  void popStreamListener(void _) {}\r\n \r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n-     RouteState.of(context).registerAsListener(popStreamListener);\r\n-    \r\n-    stream.listen(popStreamListener);\r\n+    var stream = RouteState.of(context).popStream.listen(popStreamListener);\r\n+    stream.\r\n   }\r\n \r\n   @override\r\n   void initState() {\r\n"
                },
                {
                    "date": 1698768016816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,6 @@\n+import \"dart:async\";\r\n+\r\n import \"package:flutter/material.dart\";\r\n import \"package:fridgital/icons/figma_icon_font.dart\";\r\n import \"package:fridgital/shared/constants.dart\";\r\n import \"package:fridgital/shared/extensions/times.dart\";\r\n@@ -21,8 +23,9 @@\n /// to compute their offsets and then animate them.\r\n ///\r\n /// I need tips.\r\n class _ShrinkingNavigationState extends State<ShrinkingNavigation> with TickerProviderStateMixin {\r\n+   StreamSubscription<void>? subscription;\r\n   bool isRetracted = false;\r\n \r\n   void updateRetracted() {\r\n     setState(() {\r\n@@ -56,15 +59,13 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n-\r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n \r\n-    var stream = RouteState.of(context).popStream.listen(popStreamListener);\r\n-    stream.\r\n+    subscription ?= RouteState.of(context).popStream.listen(popStreamListener);\r\n   }\r\n \r\n   @override\r\n   void initState() {\r\n"
                },
                {
                    "date": 1698768058385,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,11 @@\n       setState(() => hasComputedOffsets = true);\r\n     }\r\n   }\r\n \r\n-  void popStreamListener(void _) {}\r\n+  void popStreamListener(void _) {\r\n+    \r\n+  }\r\n \r\n   @override\r\n   void didChangeDependencies() {\r\n     super.didChangeDependencies();\r\n"
                },
                {
                    "date": 1698768107410,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,9 +60,8 @@\n     }\r\n   }\r\n \r\n   void popStreamListener(void _) {\r\n-    print(\"Popped\");\r\n   }\r\n \r\n   @override\r\n   void didChangeDependencies() {\r\n"
                }
            ],
            "date": 1698745464139,
            "name": "Commit-0",
            "content": "import \"package:flutter/material.dart\";\r\nimport \"package:fridgital/icons/figma_icon_font.dart\";\r\nimport \"package:fridgital/shared/constants.dart\";\r\nimport \"package:fridgital/shared/extensions/times.dart\";\r\nimport \"package:fridgital/widgets/inherited_widgets/tab_information.dart\";\r\nimport \"package:fridgital/widgets/shared/helper/animated_transform.dart\";\r\n\r\nclass ShrinkingNavigation extends StatefulWidget {\r\n  const ShrinkingNavigation({required this.latestScrollOffset, super.key});\r\n\r\n  final ValueNotifier<double> latestScrollOffset;\r\n\r\n  @override\r\n  State<ShrinkingNavigation> createState() => _ShrinkingNavigationState();\r\n}\r\n\r\n/// I need help. I do not know of a better way to do this.\r\n/// It works, but I have to render three layers of the same widget\r\n/// to compute their offsets and then animate them.\r\n///\r\n/// I need tips.\r\nclass _ShrinkingNavigationState extends State<ShrinkingNavigation> with TickerProviderStateMixin {\r\n  bool isRetracted = false;\r\n\r\n  void updateRetracted() {\r\n    setState(() {\r\n      isRetracted = widget.latestScrollOffset.value > 0.0;\r\n    });\r\n  }\r\n\r\n  void toggleRetracted() {\r\n    setState(() => isRetracted = !isRetracted);\r\n  }\r\n\r\n  void updateOffsets() {\r\n    if (parentKey.currentContext?.findRenderObject() case RenderBox parentBox) {\r\n      for (var (i, key) in navigationKeys.indexed) {\r\n        if (key.currentContext?.findRenderObject() case RenderBox box) {\r\n          navigationOffsets[i] = box.localToGlobal(Offset.zero, ancestor: parentBox) +\r\n              Offset(0.0, box.size.height * 1.0625) +\r\n              Offset(box.size.width / 2, 0.0) +\r\n              const Offset(-8.0, 0.0);\r\n        }\r\n      }\r\n\r\n      /// Compute the difference.\r\n      if (retractedKey.currentContext?.findRenderObject() case RenderBox retractedBox) {\r\n        if (expandedKey.currentContext?.findRenderObject() case RenderBox expandedBox) {\r\n          retractedOffset = expandedBox.localToGlobal(Offset.zero) - retractedBox.localToGlobal(Offset.zero);\r\n        }\r\n      }\r\n\r\n      setState(() => hasComputedOffsets = true);\r\n    }\r\n  }\r\n\r\n  @override\r\n  void initState() {\r\n    super.initState();\r\n\r\n    widget.latestScrollOffset.addListener(updateRetracted);\r\n    WidgetsBinding.instance.addPostFrameCallback((_) {\r\n      updateOffsets();\r\n    });\r\n  }\r\n\r\n  @override\r\n  void dispose() {\r\n    widget.latestScrollOffset.removeListener(updateRetracted);\r\n\r\n    super.dispose();\r\n  }\r\n\r\n  bool hasComputedOffsets = false;\r\n  GlobalKey parentKey = GlobalKey();\r\n\r\n  GlobalKey retractedKey = GlobalKey();\r\n  GlobalKey expandedKey = GlobalKey();\r\n\r\n  Offset retractedOffset = Offset.zero;\r\n\r\n  List<Offset> navigationOffsets = List.generate(4, (_) => Offset.zero);\r\n  List<GlobalKey> navigationKeys = List.generate(4, (_) => GlobalKey());\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    const ghostOpacity = 0.00;\r\n    const retractDuration = Duration(milliseconds: 125);\r\n\r\n    const iconSize = 32.0;\r\n    const margin = 20.0;\r\n    const padding = 8.0;\r\n    const indicator = (width: 16.0, height: 4.0);\r\n\r\n    var activeIndex = TabInformation.of(context).index;\r\n    var width = MediaQuery.sizeOf(context).width - margin * 2 - padding * 2;\r\n    var arbitraryRetracted = iconSize + padding * 2;\r\n\r\n    return Padding(\r\n      padding: const EdgeInsets.all(margin),\r\n      child: Stack(\r\n        alignment: Alignment.centerRight,\r\n        children: [\r\n          /// Evaluated if the navigation is retracted\r\n          IgnorePointer(\r\n            child: Opacity(\r\n              opacity: ghostOpacity,\r\n              child: Container(\r\n                padding: const EdgeInsets.all(padding),\r\n                width: arbitraryRetracted,\r\n                child: UnconstrainedBox(\r\n                  constrainedAxis: Axis.vertical,\r\n                  alignment: Alignment.centerRight,\r\n                  clipBehavior: Clip.hardEdge,\r\n                  child: SizedBox(\r\n                    width: width,\r\n                    child: Row(\r\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\r\n                      children: [\r\n                        for (void _ in 4.times) const SizedBox(height: iconSize, width: iconSize),\r\n                        Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent, key: retractedKey),\r\n                      ],\r\n                    ),\r\n                  ),\r\n                ),\r\n              ),\r\n            ),\r\n          ),\r\n\r\n          /// Evaluated if the navigation is not retracted\r\n          IgnorePointer(\r\n            child: Opacity(\r\n              opacity: ghostOpacity,\r\n              child: Container(\r\n                padding: const EdgeInsets.all(padding),\r\n                width: width,\r\n                child: UnconstrainedBox(\r\n                  constrainedAxis: Axis.vertical,\r\n                  alignment: Alignment.centerRight,\r\n                  clipBehavior: Clip.hardEdge,\r\n                  child: SizedBox(\r\n                    width: width,\r\n                    child: Row(\r\n                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n                      children: [\r\n                        for (var i = 0; i < 4; ++i) const SizedBox(height: iconSize, width: iconSize),\r\n                        Icon(null, size: iconSize, key: expandedKey),\r\n                      ],\r\n                    ),\r\n                  ),\r\n                ),\r\n              ),\r\n            ),\r\n          ),\r\n\r\n          /// Actual displayed.\r\n          AnimatedContainer(\r\n            padding: const EdgeInsets.all(padding),\r\n            decoration: BoxDecoration(\r\n              color: FigmaColors.whiteAccent,\r\n              borderRadius: BorderRadius.circular(256.0),\r\n            ),\r\n            onEnd: () {\r\n              WidgetsBinding.instance.addPostFrameCallback((_) {\r\n                if (!isRetracted) {\r\n                  updateOffsets();\r\n                }\r\n              });\r\n            },\r\n            duration: retractDuration,\r\n            width: isRetracted ? arbitraryRetracted : width,\r\n            curve: Curves.fastOutSlowIn,\r\n            child: Stack(\r\n              children: [\r\n                UnconstrainedBox(\r\n                  key: parentKey,\r\n                  constrainedAxis: Axis.vertical,\r\n                  alignment: Alignment.centerRight,\r\n                  clipBehavior: Clip.hardEdge,\r\n                  child: SizedBox(\r\n                    width: width,\r\n                    child: Row(\r\n                      mainAxisAlignment: MainAxisAlignment.spaceEvenly,\r\n                      children: [\r\n                        for (int i in 4.times)\r\n                          MouseRegion(\r\n                            cursor: SystemMouseCursors.click,\r\n                            child: GestureDetector(\r\n                              onTap: () {\r\n                                ShrinkingNavigationUpdateNotification(i).dispatch(context);\r\n                              },\r\n                              child: Container(\r\n                                height: iconSize,\r\n                                width: iconSize,\r\n                                color: Colors.transparent,\r\n                                key: navigationKeys[i],\r\n                                child: Center(\r\n                                  child: Icon(\r\n                                    const [\r\n                                      FigmaIconFont.book,\r\n                                      FigmaIconFont.fridge,\r\n                                      Icons.home_outlined,\r\n                                      Icons.list_alt_outlined,\r\n                                    ][i],\r\n                                    size: iconSize,\r\n                                    color: FigmaColors.pinkAccent,\r\n                                  ),\r\n                                ),\r\n                              ),\r\n                            ),\r\n                          ),\r\n                        AnimatedTransform.translate(\r\n                          duration: retractDuration,\r\n                          offset: isRetracted ? -retractedOffset : Offset.zero,\r\n                          curve: Curves.fastOutSlowIn,\r\n                          child: MouseRegion(\r\n                            cursor: SystemMouseCursors.click,\r\n                            child: GestureDetector(\r\n                              onTap: toggleRetracted,\r\n                              child: const Icon(Icons.menu, size: iconSize, color: FigmaColors.pinkAccent),\r\n                            ),\r\n                          ),\r\n                        ),\r\n                      ],\r\n                    ),\r\n                  ),\r\n                ),\r\n                if (!isRetracted && hasComputedOffsets)\r\n                  AnimatedTransform.translate(\r\n                    offset: navigationOffsets[activeIndex],\r\n                    duration: retractDuration,\r\n                    curve: Curves.fastOutSlowIn,\r\n                    child: Opacity(\r\n                      opacity: isRetracted ? 0.0 : 1.0,\r\n                      child: Container(\r\n                        width: indicator.width,\r\n                        height: indicator.height,\r\n                        decoration: BoxDecoration(\r\n                          color: FigmaColors.pinkAccent,\r\n                          borderRadius: BorderRadius.circular(256.0),\r\n                        ),\r\n                      ),\r\n                    ),\r\n                  ),\r\n              ],\r\n            ),\r\n          ),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n}\r\n\r\nsealed class ShrinkingNavigationNotification extends Notification {}\r\n\r\nclass ShrinkingNavigationUpdateNotification extends ShrinkingNavigationNotification {\r\n  ShrinkingNavigationUpdateNotification(this.index);\r\n\r\n  final int index;\r\n}\r\n"
        }
    ]
}